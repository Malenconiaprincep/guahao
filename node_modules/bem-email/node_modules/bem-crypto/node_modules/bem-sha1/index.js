'use strict';

var crypto = require('crypto');

let buildSum = function(str, key) {
  let sum;
  if (key) {
    sum = crypto.createHmac('sha1', key);
  } else {
    sum = crypto.createHash('sha1');
  }
  sum.update(str);
  return sum;
}

let sha1 = function(str, key) {
  let sum = buildSum(str, key);
  return sum.digest('hex');
};

sha1.base64 = function(str, key) {
  let sum = buildSum(str, key);
  return sum.digest('base64');
};

module.exports = sha1;
