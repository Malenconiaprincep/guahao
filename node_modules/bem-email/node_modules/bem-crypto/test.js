'use strict'

var assert = require("assert");
var BemCrypto = require('./');

describe('BemCrypto', function() {
  describe('set', function() {

    it('sha1', function(done) {
      let result = BemCrypto.sha1('hello');
      assert.equal(result, 'aaf4c61ddcc5e8a2dabede0f3b482cd9aea9434d');
      done();
    });

    it('sha1 with key', function(done) {
      let result = BemCrypto.sha1('hello', 'key');
      assert.equal(result, 'b34ceac4516ff23a143e61d79d0fa7a4fbe5f266');
      done();
    });

    it('md5', function(done) {
      let result = BemCrypto.md5('hello');
      assert.equal(result, '5d41402abc4b2a76b9719d911017c592');
      done();
    });

    it('md5 with key', function(done) {
      let result = BemCrypto.md5('hello', 'key');
      assert.equal(result, '04130747afca4d79e32e87cf2104f087');
      done();
    });

    it('base64 encode', function(done) {
      let result = BemCrypto.base64.encode('04130747afca4d79e32e87cf2104f087');
      assert.equal(result, 'MDQxMzA3NDdhZmNhNGQ3OWUzMmU4N2NmMjEwNGYwODc=');
      done();
    });

    it('base64 decode', function(done) {
      let result = BemCrypto.base64.decode('MDQxMzA3NDdhZmNhNGQ3OWUzMmU4N2NmMjEwNGYwODc=');
      assert.equal(result, '04130747afca4d79e32e87cf2104f087');
      done();
    });

  });
});
